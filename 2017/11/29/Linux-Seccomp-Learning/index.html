<!DOCTYPE HTML>
<html>

<head>
	<link rel="bookmark"  type="image/x-icon"  href="/img/logo_miccall.png"/>
	 <link rel="shortcut icon" href="/img/logo_miccall.png">
	
			
    <title>
    w0lfzhang's blog
    </title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="/css/mic_main.css" />
    <link rel="stylesheet" href="/css/dropdownMenu.css" />
    
    	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	
    <noscript>
        <link rel="stylesheet" href="/css/noscript.css" />
    </noscript>

			    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.scrollex.min.js"></script>
    <script src="/js/jquery.scrolly.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/util.js"></script>
    <script src="/js/main.js"></script>
	
</head>
    
		
<!-- Layouts -->



<!--  代码渲染  -->
<link rel="stylesheet" href="/css/prism_coy.css" />
<link rel="stylesheet" href="/css/typo.css" />
<!-- 文章页 -->
<body class="is-loading">
    <!-- Wrapper 外包 s-->
    <div id="wrapper" class="fade-in">
        <!-- Intro 头部显示 s -->
        <!-- Intro 头部显示 e -->
        <!-- Header 头部logo start -->
        <header id="header">
    <a href="/" class="logo">MICCALL</a>
</header>
        <!-- Nav 导航条 start -->
        <nav id="nav" class="special" >
            <ul class="menu links" >
			<!-- Homepage  主页  --> 
			<li >
	            <a href="/" rel="nofollow">主页</a>
	        </li>
			<!-- categories_name  分类   --> 
	        
	        <li class="active">
	            <a href="#s1">分类</a>
	                    <ul class="submenu">
	                        <li>
	                        <a class="category-link" href="/categories/arm/">arm</a></li><li><a class="category-link" href="/categories/crypto/">crypto</a></li><li><a class="category-link" href="/categories/ctf-practice/">ctf_practice</a></li><li><a class="category-link" href="/categories/cve-analysis/">cve_analysis</a></li><li><a class="category-link" href="/categories/fuzzing/">fuzzing</a></li><li><a class="category-link" href="/categories/heap-exploit/">heap_exploit</a></li><li><a class="category-link" href="/categories/kernel-development/">kernel_development</a></li><li><a class="category-link" href="/categories/kernel-exploit/">kernel_exploit</a></li><li><a class="category-link" href="/categories/kernel-exploit-practice/">kernel_exploit_practice</a></li><li><a class="category-link" href="/categories/linux-security/">linux security</a></li><li><a class="category-link" href="/categories/misc-exploit/">misc_exploit</a></li><li><a class="category-link" href="/categories/pwnable-kr/">pwnable.kr</a></li><li><a class="category-link" href="/categories/stack-exploit/">stack_exploit</a></li><li><a class="category-link" href="/categories/windows-exploit/">windows_exploit</a>
	                    </ul>
	        </li>
	        
	        <!-- archives  归档   --> 
	        
	        
		        <!-- Pages 自定义   -->
		        
		        <li>
		            <a href="/about/" title="简历">
		                简历
		            </a>
		        </li>
		        
		        <li>
		            <a href="/group/" title="团队">
		                团队
		            </a>
		        </li>
		        
		        <li>
		            <a href="/gallery/" title="图库">
		                图库
		            </a>
		        </li>
		        
		        <li>
		            <a href="/tag/" title="标签">
		                标签
		            </a>
		        </li>
		        


            </ul>
            <!-- icons 图标   -->
			<ul class="icons">
		            
		                <li><a href="https://github.com/miccall" class="icon fa-github"><span class="label">GitHub</span></a></li>
		            
		            
		            
		            
			</ul>
</nav>

        <div id="main" >
            <div class ="post_page_title_img" style="height: 25rem;background-image: url(undefined);background-position: center; background-repeat:no-repeat; background-size:cover;-moz-background-size:cover;overflow:hidden;" >
                <a href="#" style="padding: 4rem 4rem 2rem 4rem ;"><h2 >Linux Seccomp Learning</h2></a>
            </div>
            <!-- Post -->
            <div class="typo" style="padding: 3rem;">
                <p>It’s been a long time since I wrote my last blog. Lazy and busy! </p>
<h2 id="What-is-seccomp"><a href="#What-is-seccomp" class="headerlink" title="What is seccomp"></a>What is seccomp</h2><p>seccomp (short for secure computing mode) is a computer security facility in the Linux kernel which was merged into the Linux kernel mainline in kernel version 2.6.12. As we all know, plenty of system calls are exposed to the programs directly, but not all system calls are needed to the users, which will be dangerous if someone abuses the system calls. By using seccomp, we can limit the program to use the specific system calls, which can make the system more secure.<br><a id="more"></a></p>
<h2 id="How-to-use-it"><a href="#How-to-use-it" class="headerlink" title="How to use it"></a>How to use it</h2><p>seccomp mode can be enabled via the prctl(2) system call using the PR_SET_SECCOMP argument, or (since Linux kernel 3.17[4]) via the seccomp(2) system call and the prerequisite is the kernel is configured with CONFIG_SECCOMP and CONFIG_SECCOMP_FILTER. seccomp mode used to be enabled by writing to a file, /proc/self/seccomp, but this method was removed in favor of prctl().<br>seccomp supports two modes: SECCOMP_MODE_STRICT and SECCOMP_MODE_FILTER. In SECCOMP_MODE_STRICT, it cannot use any system calls except exit(), sigreturn(), read() and write().<br>Have a look at the <a href="http://elixir.free-electrons.com/linux/v3.13.1/source/kernel/seccomp.c#L377" target="_blank" rel="external">kernel source code</a>:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> __secure_computing(<span class="keyword">int</span> this_syscall)</div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> mode = current-&gt;seccomp.mode;</div><div class="line">	<span class="keyword">int</span> exit_sig = <span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span> *syscall;</div><div class="line">	u32 ret;</div><div class="line"></div><div class="line">	<span class="keyword">switch</span> (mode) &#123;</div><div class="line">	<span class="keyword">case</span> SECCOMP_MODE_STRICT:</div><div class="line">		syscall = mode1_syscalls;</div><div class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> CONFIG_COMPAT</span></div><div class="line">		<span class="keyword">if</span> (is_compat_task())</div><div class="line">			syscall = mode1_syscalls_32;</div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">		<span class="keyword">do</span> &#123;</div><div class="line">			<span class="keyword">if</span> (*syscall == this_syscall)</div><div class="line">				<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		&#125; <span class="keyword">while</span> (*++syscall);</div><div class="line">		exit_sig = SIGKILL;</div><div class="line">		ret = SECCOMP_RET_KILL;</div><div class="line">		<span class="keyword">break</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> CONFIG_SECCOMP_FILTER</span></div><div class="line">	<span class="keyword">case</span> SECCOMP_MODE_FILTER: &#123;</div><div class="line">		......</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>model_syscalls is the array including the syscall numbers of exit(), sigreturn(), read() and write().<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="keyword">int</span> mode1_syscalls[] = &#123;</div><div class="line">	__NR_seccomp_read, __NR_seccomp_write, __NR_seccomp_exit, __NR_seccomp_sigreturn,</div><div class="line">	<span class="number">0</span>, <span class="comment">/* null terminated */</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>In SECCOMP_MODE_FILTER, since linux 3.5, it is possible to define advanced custom filters based on the BPF (Berkley Packet Filters) to limit what system calls and their arguments can be used by the process. In this mode, the caller must have the CAP_SYS_ADMIN ability or the thread must have been set <a href="https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt" target="_blank" rel="external">no_new_privs</a>.<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">case</span> SECCOMP_MODE_FILTER: &#123;</div><div class="line">		<span class="keyword">int</span> data;</div><div class="line">		<span class="class"><span class="keyword">struct</span> <span class="title">pt_regs</span> *<span class="title">regs</span> = <span class="title">task_pt_regs</span>(<span class="title">current</span>);</span></div><div class="line">		ret = seccomp_run_filters(this_syscall);</div><div class="line">		data = ret &amp; SECCOMP_RET_DATA;</div><div class="line">		ret &amp;= SECCOMP_RET_ACTION;</div><div class="line">		<span class="keyword">switch</span> (ret) &#123;</div><div class="line">		<span class="keyword">case</span> SECCOMP_RET_ERRNO:</div><div class="line">			<span class="comment">/* Set the low-order 16-bits as a errno. */</span></div><div class="line">			syscall_set_return_value(current, regs,</div><div class="line">						 -data, <span class="number">0</span>);</div><div class="line">			<span class="keyword">goto</span> skip;</div><div class="line">		<span class="keyword">case</span> SECCOMP_RET_TRAP:</div><div class="line">			<span class="comment">/* Show the handler the original registers. */</span></div><div class="line">			syscall_rollback(current, regs);</div><div class="line">			<span class="comment">/* Let the filter pass back 16 bits of data. */</span></div><div class="line">			seccomp_send_sigsys(this_syscall, data);</div><div class="line">			<span class="keyword">goto</span> skip;</div><div class="line">		<span class="keyword">case</span> SECCOMP_RET_TRACE:</div><div class="line">			<span class="comment">/* Skip these calls if there is no tracer. */</span></div><div class="line">			<span class="keyword">if</span> (!ptrace_event_enabled(current, PTRACE_EVENT_SECCOMP)) &#123;</div><div class="line">				syscall_set_return_value(current, regs,</div><div class="line">							 -ENOSYS, <span class="number">0</span>);</div><div class="line">				<span class="keyword">goto</span> skip;</div><div class="line">			&#125;</div><div class="line">			<span class="comment">/* Allow the BPF to provide the event message */</span></div><div class="line">			ptrace_event(PTRACE_EVENT_SECCOMP, data);</div><div class="line">			<span class="comment">/*</span></div><div class="line">			 * The delivery of a fatal signal during event</div><div class="line">			 * notification may silently skip tracer notification.</div><div class="line">			 * Terminating the task now avoids executing a system</div><div class="line">			 * call that may not be intended.</div><div class="line">			 */</div><div class="line">			<span class="keyword">if</span> (fatal_signal_pending(current))</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			<span class="keyword">if</span> (syscall_get_nr(current, regs) &lt; <span class="number">0</span>)</div><div class="line">				<span class="keyword">goto</span> skip;  <span class="comment">/* Explicit request to skip. */</span></div><div class="line"></div><div class="line">			<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		<span class="keyword">case</span> SECCOMP_RET_ALLOW:</div><div class="line">			<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		<span class="keyword">case</span> SECCOMP_RET_KILL:</div><div class="line">		<span class="keyword">default</span>:</div><div class="line">			<span class="keyword">break</span>;</div><div class="line">		&#125;</div><div class="line">		exit_sig = SIGSYS;</div><div class="line">		<span class="keyword">break</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line"><span class="comment">/* Masks for the return value sections. */</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> SECCOMP_RET_ACTION	0x7fff0000U</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> SECCOMP_RET_DATA	0x0000ffffU</span></div></pre></td></tr></table></figure></p>
<p>Each syscall is sent to the filter which tells what action to take:</p>
<ol>
<li>SECCOMP_RET_KILL: Immediate kill with SIGSYS</li>
<li>SECCOMP_RET_TRAP: Send a catchable SIGSYS, giving a chance to emulate the syscall</li>
<li>SECCOMP_RET_ERRNO: Force errno value</li>
<li>SECCOMP_RET_TRACE: Yield decision to ptracer or set errno to -ENOSYS</li>
<li>SECCOMP_RET_ALLOW: Allow</li>
</ol>
<p>In the code, seccomp_run_filters returns valid seccomp BPF response codes. And then choose what to do according to ‘ret’. Of course we can control the ‘response codes’ in user space through seecomp or prctl syscall.</p>
<p>Last, we can see if seccomp is set via read the file /proc/<pid>/status:<br>0: closed.<br>1: in STRICT mode.<br>2: in FILTER mode.<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">w0lfzhang@w0lfzhang666:~/Desktop/linux-security$ cat /proc/1/status | grep Seccomp</div><div class="line">Seccomp:	0</div></pre></td></tr></table></figure></pid></p>
<h2 id="Demos-to-show"><a href="#Demos-to-show" class="headerlink" title="Demos to show"></a>Demos to show</h2><h3 id="SECCOMP-MODE-STRICT"><a href="#SECCOMP-MODE-STRICT" class="headerlink" title="SECCOMP_MODE_STRICT"></a>SECCOMP_MODE_STRICT</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;         /* printf */</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/prctl.h&gt;     /* prctl */</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/seccomp.h&gt; /* seccomp's constants */</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;        /* dup2: just for test */</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="built_in">printf</span>(<span class="string">"step 1: unrestricted\n"</span>);</div><div class="line"></div><div class="line">  <span class="comment">// Enable filtering</span></div><div class="line">  prctl(PR_SET_SECCOMP, SECCOMP_MODE_STRICT);</div><div class="line">  <span class="built_in">printf</span>(<span class="string">"step 2: only 'read', 'write', 'exit' and 'sigreturn' syscalls\n"</span>);</div><div class="line">  </div><div class="line">  <span class="comment">// Redirect stderr to stdout</span></div><div class="line">  dup2(<span class="number">1</span>, <span class="number">2</span>);</div><div class="line">  <span class="built_in">printf</span>(<span class="string">"step 3: !! YOU SHOULD NOT SEE ME !!\n"</span>);</div><div class="line"></div><div class="line">  <span class="comment">// Success (well, not so in this case...)</span></div><div class="line">  <span class="keyword">return</span> <span class="number">0</span>; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>When running the program:<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">w0lfzhang@w0lfzhang666:~/Desktop/linux-security$ ./seccomp1 </div><div class="line">step 1: unrestricted</div><div class="line">step 2: only 'read', 'write', '_exit' and 'sigreturn' syscalls</div><div class="line">Killed</div></pre></td></tr></table></figure></p>
<p>So it’s apparent when a forbidden syscall is issued, the program is immediately killed.</p>
<h3 id="SECCOMP-MODE-FILTER"><a href="#SECCOMP-MODE-FILTER" class="headerlink" title="SECCOMP_MODE_FILTER"></a>SECCOMP_MODE_FILTER</h3><p>We can use libseccomp to simplify our work:<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install libseccomp-dev</div></pre></td></tr></table></figure></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;   /* printf */</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;  /* dup2: just for test */</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;seccomp.h&gt; /* libseccomp */</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="built_in">printf</span>(<span class="string">"step 1: unrestricted\n"</span>);</div><div class="line"></div><div class="line">  <span class="comment">// ensure none of our children will ever be granted more priv</span></div><div class="line">  <span class="comment">// (via setuid, capabilities, ...)</span></div><div class="line">  prctl(PR_SET_NO_NEW_PRIVS, <span class="number">1</span>);</div><div class="line">  <span class="comment">// ensure no escape is possible via ptrace</span></div><div class="line">  prctl(PR_SET_DUMPABLE, <span class="number">0</span>);</div><div class="line">  </div><div class="line">  <span class="comment">// Init the filter</span></div><div class="line">  scmp_filter_ctx ctx;</div><div class="line">  ctx = seccomp_init(SCMP_ACT_KILL); <span class="comment">// default action: kill</span></div><div class="line"></div><div class="line">  <span class="comment">// setup basic whitelist</span></div><div class="line">  seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(rt_sigreturn), <span class="number">0</span>);</div><div class="line">  seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(<span class="built_in">exit</span>), <span class="number">0</span>);</div><div class="line">  seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(read), <span class="number">0</span>);</div><div class="line">  seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(write), <span class="number">0</span>);</div><div class="line">  </div><div class="line">  <span class="comment">// setup our rule</span></div><div class="line">  seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(dup2), <span class="number">2</span>, </div><div class="line">                        SCMP_A0(SCMP_CMP_EQ, <span class="number">1</span>),</div><div class="line">                        SCMP_A1(SCMP_CMP_EQ, <span class="number">2</span>));</div><div class="line"></div><div class="line">  <span class="comment">// build and load the filter</span></div><div class="line">  seccomp_load(ctx);</div><div class="line">  <span class="built_in">printf</span>(<span class="string">"step 2: only the whitelist and dup2(1, 2) syscalls\n"</span>);</div><div class="line"> </div><div class="line">  <span class="comment">// Redirect stderr to stdout</span></div><div class="line">  dup2(<span class="number">1</span>, <span class="number">2</span>);</div><div class="line">  <span class="built_in">printf</span>(<span class="string">"step 3: stderr redirected to stdout\n"</span>);</div><div class="line"></div><div class="line">  <span class="comment">// Duplicate stderr to arbitrary fd</span></div><div class="line">  dup2(<span class="number">2</span>, <span class="number">42</span>);</div><div class="line">  <span class="built_in">printf</span>(<span class="string">"step 4: !! YOU SHOULD NOT SEE ME !!\n"</span>);</div><div class="line"></div><div class="line">  <span class="comment">// Success (well, not so in this case...)</span></div><div class="line">  <span class="keyword">return</span> <span class="number">0</span>; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Run the program:<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">w0lfzhang@w0lfzhang666:~/Desktop/linux-security$ ./seccomp2</div><div class="line">step 1: unrestricted</div><div class="line">step 2: only the whitelist and dup2(1, 2) syscalls</div><div class="line">step 3: stderr redirected to stdout</div><div class="line">Bad system call</div></pre></td></tr></table></figure></p>
<h2 id="Links"><a href="#Links" class="headerlink" title="Links"></a>Links</h2><p><a href="https://blog.yadutaf.fr/2014/05/29/introduction-to-seccomp-bpf-linux-syscall-filter/" target="_blank" rel="external">Introduction to seccomp: BPF linux syscall filter</a><br><a href="https://szlin.me/2017/08/23/kernel_seccomp/" target="_blank" rel="external">seccomp 學習筆記</a><br><a href="http://man7.org/linux/man-pages/man2/seccomp.2.html" target="_blank" rel="external">SECCOMP(2) Linux Programmer’s Manual SECCOMP(2)</a></p>

            </div>

            <!-- Post Comments -->
            
    <!-- 使用 DISQUS_CLICK -->
<div id="disqus-comment">
    <div id="disqus_thread"></div>

<!-- add animation -->
<style>
	.disqus_click_btn {
            line-height: 30px;
            margin: 0;
            min-width: 50px;
            padding: 0 14px;
            display: inline-block;
            font-family: "Roboto", "Helvetica", "Arial", sans-serif;
            font-size: 14px;
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 0;
            overflow: hidden;
            will-change: box-shadow;
            transition: box-shadow .2s cubic-bezier(.4, 0, 1, 1), background-color .2s cubic-bezier(.4, 0, .2, 1), color .2s cubic-bezier(.4, 0, .2, 1);
            outline: 0;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            vertical-align: middle;
            border: 0;
            background: rgba(158, 158, 158, .2);
            box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .14), 0 3px 1px -2px rgba(0, 0, 0, .2), 0 1px 5px 0 rgba(0, 0, 0, .12);
            color: #fff;
            background-color: #7EC0EE;
            text-shadow: 0
        }
</style>
	
<div class="btn_click_load" id="disqus_bt"> 
    <button class="disqus_click_btn">点击查看评论</button>
</div>

<!--
<script type="text/javascript">
$('.btn_click_load').click(function() {
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'http-miccall-tech'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    document.getElementById('disqus_bt').style.display = "none";
});
</script>
-->
<script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'http://yoursite.com/2017/11/29/Linux-Seccomp-Learning/';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = 'http://yoursite.com/2017/11/29/Linux-Seccomp-Learning/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
</script>

<script type="text/javascript">
    $('.btn_click_load').click(function() {  //click to load comments
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document;
            var s = d.createElement('script');
            s.src = '//http-miccall-tech.disqus.com/embed.js';
            s.setAttribute('data-timestamp', + new Date());
            (d.head || d.body).appendChild(s);
        })();
        $('.btn_click_load').css('display','none');
    });
</script>
</div>
<style>
    #disqus-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>


        </div>
        <!-- Copyright 版权 start -->
                <div id="copyright">
            <ul>
                <li>&copy;Powered By <a href="https://hexo.io/zh-cn/" style="border-bottom: none;">hexo</a></li>
                <li>Design: <a href="http://miccall.tech " style="border-bottom: none;">miccall</a></li>
            </ul>
            
            	<span id="busuanzi_container_site_pv">2017总访问量<span id="busuanzi_value_site_pv"></span>次</span>
			
        </div>
    </div>
</body>



 	
</html>
